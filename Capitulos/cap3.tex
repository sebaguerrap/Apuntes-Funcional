\chapter{Espacios de Hilbert}

\section{Conceptos Básicos}

\begin{fdefinition}
    Sea $H$ un espacio vectorial sobre $\K=\R$ o $\C$. Un producto interno $\langle \cdot,\cdot\rangle$ es una función $H\times H\to \K$ que satisface

    \begin{enumerate}
        \item Linealidad en $\langle\cdot,y\rangle,\quad \forall y\in H$:
        
        \[\langle x_1+x_2,y\rangle=\langle x_1,y\rangle+\langle x_2,y\rangle\]
        \[\langle \lambda x,y\rangle = \lambda \langle x,y\rangle\]

        \item (Hermiticidad)
        
        \[\langle y,x\rangle=\overline{\langle x,y\rangle}\]

        (En $\K=\R$, esto es simetría)

        \item (Definidad) $\langle x,x\rangle\geq 0$ y $\langle x,x\rangle=\implies x=0$
    \end{enumerate}
\end{fdefinition}

\begin{fnote}
    1. y 2., implican que $\langle x,\cdot\rangle$ es lineal conjugada en la segunda entrada.

    \[\langle x,\lambda y+z\rangle=\overline{\lambda}\langle x,y\rangle + \langle x,z\rangle\]
\end{fnote}

\paragraph*{Terminología} Tal función se llama \textbf{forma sesquilineal}

\begin{fnote}
    $\K=\R$, $\inn{\cdot,\cdot}$ es una \textbf{forma simétrica definida positiva}
\end{fnote}

Decimos que $(H,\inn{\cdot,\cdot})$ es un \textbf{espacio pre-Hilbertiano}

De 1. y 2., $\inn{0,y}=0$, $\inn{x,0}=0$

Definimos $||x||:=\inn{x,x}^{1/2}$

\begin{fproposition}[Desigualdad de Cauchy-Schwarz]
    Sea $H$ un espacio pre-Hilbertiano

    \[|\inn{x,y}|\leq ||x||\cdot ||y||\quad \forall x,y\in H\]
\end{fproposition}

\begin{proof}
    Si $y=0$, la desigualdad es verdadera. Podemos asumir que $y\neq 0$.

    \begin{align*}
        0&\leq \inn{x+\lambda y,x+\lambda y}\\
        &=\inn{x,x}+\lambda\inn{y,x}+\overline{\lambda}\inn{x,y}+\lambda \overline{\lambda}\inn{y,y}\\
        &=||x||^2 +\underbrace{\lambda \overline{\inn{x,y}}+\overline{\lambda}\inn{x,y}}_{2\Re (\inn{x,y}\overline{\lambda})}+|\lambda|^2|\cdot |y||^2
    \end{align*}

    Evaluando en $\lambda=-\dfrac{\inn{x,y}}{||y||^2}$

    \begin{align*}
        0&\leq ||x||^2+2\Re (\inn{x,y}\frac{-\overline{\inn{x,y}}}{||y||^2})\\
        0&\leq ||x||^2-2\frac{|\inn{x,y}|^2}{||y||^2}+\frac{|\inn{x,y}|^2}{||y||^2}\\
        &\implies ||x||^2\geq \frac{|\inn{x,y}|^2}{||y||^2}
    \end{align*}
\end{proof}

\begin{fproposition}
    $||\cdot||$ define una norma $H$.
\end{fproposition}
\begin{proof}
    \begin{enumerate}
        \item Definidad $\checkmark$
        \item $||\lambda x||=\inn{\lambda x,\lambda x}^{1/2}=(\lambda \overline{\lambda}||x||^2)^{1/2}=|\lambda|\cdot ||x||$
        \item (Desigualdad triangular)
        
        \begin{align*}
            ||x+y||^2=||x||^2+2\Re (\inn{x,y})+||y||^2&\leq ||x||^2+2||x||\cdot ||y||+||y||^2\\
            &=(||x||+||y||)^2
        \end{align*}
    \end{enumerate}
\end{proof}

\begin{fproposition}
    $\inn{\cdot,\cdot}$ es continuo en $H\times H$
\end{fproposition}

\begin{proof}
    $x_n\to x$ en $||\cdot$ e $y_n\to y$ en $||\cdot||$

    \begin{align*}
        |\inn{x_n,y_n}-\inn{x,y}|&=|\inn{x_n-x,y_n}+\inn{x,y_n-y}|\\
        &\leq |\inn{x_n-x,y_n}|+|\inn{x,y_n-y}|\\
        &\leq ||x_n-x||\cdot ||y_n||+||x||\cdot ||y_n-y||\\
        &\xrightarrow[n\to\infty]{} 0
    \end{align*}
\end{proof}

\begin{fdefinition}
    Decimos que $x\perp y$ en el espacio pre-Hilbertiano $H$ si $\inn{x,y}=0$. Si $E\subseteq H$ subconjunto, definimos el \textbf{espacio ortogonal}

    \[E^\perp :=\{x\in H:x\perp y\quad \forall y\in E\}\]
\end{fdefinition}

$E^\perp$ es un \textbf{subespacio} de $H$ y es cerrado:

$x_n\in E^\perp$ y $x_n\to x$ en $H$ entonces 

\[\inn{x,y}=\lim_{n\to\infty} \inn{x_n,y}=0\quad \forall y\in E\]

\begin{ftheorem}[Pitagoras]
    Si $x_1,\ldots,x_n\in H$ (pre-Hilbertiano) son mutuamente ortogonales, entonces 

    \[||x_1+\cdots+x_n||^2=\sum_{k=1}^n ||x_k||^2\]
\end{ftheorem}

\begin{fproposition}[Ley del paralelogramo]
    \[||x+y||^2+||x-y||^2=2||x||^2+2||y||^2\]
\end{fproposition}

\begin{proof}
    \begin{align*}
        ||x\pm y||^2=||x||^2\pm 2\Re \inn{x,y}+||y||^2
    \end{align*}

    Sumando los 2 términos (diagonales), estamos listos.
\end{proof}

\begin{fdefinition}
    Decimos que un espacio $(H,\inn{\cdot,\cdot})$ pre-Hilbertiano es un espacio de \textbf{Hilbert} si es \textbf{completo} respecto $||\cdot||$ inducida por $\inn{\cdot,\cdot}$
\end{fdefinition}

\begin{fexample}
    $(\C^n,\inn{\cdot,\cdot})$. $\inn{x,y}=\sum_{k=1}^n x_k\overline{y_k}$ es un espacio de Hilbert.
\end{fexample}

\begin{fexample}
    $(\ell^2,\inn{\cdot,\cdot})$. $\inn{\{x_k\},\{y_k\}}=\sum_{k=1}^\infty x_k\overline{y_k}$
\end{fexample}

¿$\ell^p$ tiene una estructura de espacio de Hilbert? $\iff p=2$

\begin{fexample}
    $(X,\mathcal{M},\mu)$ es un espacio de medida, definimos 

    \[L^2(X,\mathcal{M},\mu)=\{f:X\to\C\text{ medibles}:\int_X|f|^2\,d\mu<\infty\}/_\sim\]

    $f_1\sim f_2$ si $\{f_1\neq f_2\}$ es despreciable.
\end{fexample}

\section{Teorema de la Proyección}

Sea $H$ un espacio de Hilbert. $C\subseteq R^n$ cerrado y convexo. Existe único $y\in C$ tal que $y$ minimiza la distancia entre $x$ y $C$.

\begin{fdefinition}
    Sea $C$ un subconjunto de un espacio vectorial $V$. Decimos que $C$ es \textbf{convexo} en $V$ si

    \[\forall x,y\in C\quad (1-t)x+ty\in C\quad \forall t\in [0,1]\]
\end{fdefinition}

\begin{ftheorem}
    Sea $C\subseteq H$ un subconjunto cerado y convexo del espacio de Hilbert $H$. Entonces $\forall x\in H,\exists! y=P_C x\in C$ que satisface:

    \[||x-P_C x||=d(x,C)=\inf_{c\in C} ||x-c||\]

    Además, $y=P_C x\iff \Re \inn{c-y,x-y}\leq 0,\quad \forall c\in C$
\end{ftheorem}

\begin{proof}
    Tome $\{y_n\}\subseteq C$, tal que 

    \[d_n:=||x-y_n||\xrightarrow{n\to\infty} d:=d(x_n,c)\]

    $\{y_n\}$ será convergente si es Cauchy, ya que $y_n\to y\in H$. Ya que $C$ es cerrado, de hecho $y\in C$.

    Por la ley del paralelogramo, con $v=x-y_n,w=x-y_m$

    \begin{align*}
        2 d_n^2+2 d_m^2&=||v-w||^2+||v+w||^2\\
        &=||y_n-y_m||^2+||2x-(y_n+y_m)||^2\\
        &=||y_n-y_m||^2+4\left|\left|x-\underbrace{\frac{y_n+y_m}{2}}_{\in C}\right|\right|^2\\
        &\geq ||y_n-y_m||^2+4d^2
    \end{align*}

    Luego,

    \begin{align*}
        ||y_n-y_m||^2&\leq 2d_n^2+d_m^2-4d^2\\
        &\xrightarrow{n,m\to\infty} 0
    \end{align*}

    por lo que $\{y_n\}$ es Cauchy.

    $y=\displaystyle\lim_{n\to\infty} y_n$,

    \[||x-y||=\lim_{n\to\infty} \overbrace{||x-y_n||}^{d_n}=d\]

    Este minimizador es el único!. Si hubiera otro $z\neq y$, aplicamos el mismo argumento a $\{y,z,y,z,\ldots\}$ que no converge por construcción, pero es Cauchy, lo que es una contradicción.

    $\implies:$ Sea $c\in C$ y considere $(1-t)y+tc$, $t\in [0,1]$.

    \begin{align*}
        ||x-(1-t)y-tc||^2&=||x-y-t(c-y)||^2\\
        &=||x-y||^2-2t\Re \inn{x-y,c-y}+t^2||c-y||^2\\
        &\geq ||x-y||^2
    \end{align*}

    \[\implies 2t\Re \inn{x-y,c-y}\leq t^2||c-y||^2\]
    \[\implies 2\Re \inn{x-y,c-y}\leq 0\]

    $\impliedby:$ Evalúe $||x-(1-t)y+tc||^2$ en $t=1$.

    \begin{align*}
        ||x-c||^2&=||x-y||^2-2\Re \inn{x-y,c-y}+||c-y||^2\\
        \implies & ||x-c||^2-||x-y||^2=||c-y||^2-2\Re \inn{x-y,c-y}\\
        \implies &||x-c||^2\geq ||x-y||^2\quad \forall c\in C
    \end{align*}

    Tenemos igualdad $\iff c=y$. 
\end{proof}

\begin{fexample}
    $W\subseteq H$ es un subespacio $\implies W$ es convexo.
\end{fexample}

\begin{ftheorem}
    Sea $F\subseteq H$ un subespacio cerrado. Entonces $H=F\oplus F^\perp$, es decir, que todo $x\in H$ se puede escribir de manera única como $x=y+z$ con $y\in F$ y $z\in F^\perp$. Además $y=P_Fx, z=P_{F^\perp} x$. y 

    \[P_F:H\to H\]

    es lineal, acotado y satisface:

    \begin{itemize}
        \item $||P_F||\leq 1$ ($=1$ cuando $F=\{0\}$)
        \item $P_F^2=P_F$
        \item $\I P_F=F$, $\ker P_F=F^\perp$
        \item $\inn{P_Fx_1,x_2}=\inn{x_1,P_Fx_2}$
    \end{itemize}
\end{ftheorem}

\begin{fdefinition}
    $P_F$ se llama la \textbf{proyección ortogonal}
\end{fdefinition}

\begin{proof}
    Ya que $F\cap F^\perp=\{0\}$, la unicidad se cumple.

    \[y+z=y'+z'\implies y-y'=z'-z=0\]

    Tome $x\in H$. Define $y=P_Fx$. Queremos demostrar que $x:x-y\in F^\perp$. Del teorema \ref{theo:2.5.1} sabemos que 
    
    $$\Re\inn{c-y,x-y}\leq 0\quad \forall c\in F$$.

    \[\implies \Re \inn{v,z}\leq 0\quad\forall v\in F\]
    \[\implies \Re \inn{\lambda v,z}\leq 0\quad \forall \lambda\in \K\]
    \[\implies \Re \lambda\inn{v,z}\leq 0\]

    \seba{añadir align}

    tome $\lambda=\overline{\inn{v,z}}$

    \[\implies\Re |\inn{v,z}|^2\leq 0\]
    \[\implies |\inn{v,z}|=0\implies z\in F^\perp\]

    \large{Propiedades de $P_F$:} $x_1=y_1+z,\quad x_2=y_2+z_2$

    \begin{align*}
        \inn{P_Fx_1,x_2}&=\inn{y_1,x_2}\\
        &=\inn{y_1,y_2+z_2}\\
    \end{align*}

    \begin{align*}
        \inn{x_1,P_F x_2}&=\inn{y_1+z_1,y_2}\\
        &=\inn{y_1,y_2}
    \end{align*}

    Por lo que $P_F$ es lineal

    \begin{align*}
        \inn{P_F(x_1+x_2),x_3}&=\inn{x_1+x_2,P_F x_3}\\
        &=\inn{x_1,P_Fx_3}+\inn{x_2,P_Fx_3}\\
        &=\inn{P_Fx_1,x_3}+\inn{P_Fx_2,x_3}\\
        &=\inn{(P_Fx_1+P_Fx_2),x_3}
    \end{align*}

    \[\iff P_F(x_1+x_2)=P_Fx_1+P_Fx_2\]

    $P_F(\lambda x)=\lambda P_F x$ de la misma manera.

    $P_F/_F=\Id/_F$ 

    \begin{align*}
        &\implies P_F^2 x=P_F(P_Fx)=P_F x\quad \forall x\in H\\
        &\implies P_F^2=P_F
    \end{align*}

    $||P_F x||^2=||y||^2\leq ||x||^2$ mientras

    \[||x||^2\leq ||y||^2+||z||^2\]
    \[\implies ||P_F||\leq 1\]

\end{proof}

\section{Teorema de Representación de Riesz}

\begin{ftheorem}
    Sea $H$ un espacio de Hilbert y sea $f\in H^*$ un funcional lineal acotado. Entonces existe único $u\in H$ tal que 

    \[f(x)=\inn{x,u}\quad \forall x\in H\]
\end{ftheorem}

\paragraph*{Observaciones}

\begin{enumerate}
    \item $||f||_*=||u||$ por Cauchy-Schwarz
    \item \begin{align*}
        H^*&\to H\\
        f&\to u_f
    \end{align*}
    es una isometría biyectiva, lineal-conjugada. Para todo $v\in H$ define $f_v(x):\inn{x,v}$
    \item $f_1+f_2\to u_{f_1+f_2}=u_{f_1}+u_{f_2}$, ya que
    
    \begin{align*}
        (f_1+f_2)(x)&=f_1(x)+f_2(x)=\inn{x,u_{f_1}}+\inn{x,u_{f_2}}\\
        &=\inn{x,u_{f_1}+u_{f_2}}\implies u_{f_1+f_2}=u_{f_1}+u_{f_2}
    \end{align*}

    \item ¿$\lambda f\to u_{\lambda f}=\lambda u_f$?
    
    \begin{align*}
        [\lambda f](x)=\lambda (f(x))=\lambda\inn{x,u_f}=\inn{x,\overline{\lambda}u_f}
    \end{align*}
\end{enumerate}

\begin{fnote}
    Teorema falso. Cuando $H$ es solo espacio pre-Hilbertiano, por ejemplo,

    \[H=C([-1,1])\]

    con producto interno usual.

    \[f(x)=\int_0^1 x(t)\,dt\in H^*\]

\end{fnote}

\begin{proof}
    Si $f=0\implies u=0$. Asumimos que $f\neq 0$ y consideramos $F:=\ker f=\{x\in H:f(x)=0\}$. $F$ es un subespacio de $H$ cerrado. Si $f\neq 0\implies F\neq H$. Por el teorema de la proyección (\ref{theo:3.2.2})

    \[H=F\oplus F^\perp\]

    Elije $z\in F^\perp\setminus\{0\}$. Afirmamos que $u=\overline{f(z)}z|z|^2\neq 0$ satisface $f=\inn{\cdot,u}$. Ya que 

    \begin{align*}
        f(z)x-f(x)z\in F\\
        \implies f(z)x-f(x)z\perp z\\
        \inn{f(z)x,z}-\inn{f(x)z,z}=0\\
        \implies \inn{x,\overline{f(z)}z}=f(x)||z||^2\\
        \implies f(x)=\inn{x,\frac{\overline{f(x)}z}{||z||^2}}
    \end{align*}

    Entonces $u\in H$ que satisface $f=\inn{\cdot,u}$. Es único: si tenemos $u,u'\in H$ 

    \begin{align*}
        f(x)&=\inn{x,u}=\inn{x,u'}\\\
        &\implies \inn{x,u-u'}=0\quad \forall x\in H\\
        &\implies u-u'\in H^\perp=\{0\}
    \end{align*}
\end{proof}

\section{Bases Ortonormales}

Sea $V$ un espacio vectorial sobre $\K$. Un subconjunto $\{v_\alpha\}_{\alpha\in A}$ es LI si $\forall I\overset{\text{finito}}{\subseteq} A$, 

\[\sum_{i\in I}c_iv_i=0\implies c_i=0\quad \forall i\in I\]

\[\gen (\{u_\alpha\}_{\alpha\in A})=\left\{\sum_{i\in I}c_iu_i:I\overset{\text{finito}}{\subseteq} A, c_i\in \K\right\}\]

\begin{fdefinition}
    Sea $H$ un espacio de Hilbert, $\{e_\alpha\}_{\alpha\in A}$ es ortonormal (o.n.) si 

    \[\inn{e_\alpha,e_\beta}=\delta_{\alpha\beta}\quad \text{$\delta$ de Kronecker}\]
\end{fdefinition}

Suponga que $\{e_1,\ldots,e_n\}$ es o.n.

\[F:=\gen(\{e_i\}_i^n)\subseteq H\]

es un subespacio cerrado. Podemos definir $P_F$

\[P_F x=\underbrace{\sum_{i=1}^n \inn{x,e_i}e_i}_{y}\]

Es suficiente demostrar que $x-y\perp F$.

\begin{align*}
    \inn{x-\sum_{x,e_i}e_i,e_k}=0\quad \forall k= 1,\ldots,n
\end{align*}

\begin{align*}
    ||P_F x||^2&\leq ||x||^2
\end{align*}

Por Pitagoras

\begin{align*}
    =\sum_{i=1}^n ||\inn{x,e_i}e_i||^2\leq ||x||^2\\
    \implies \sum_{i=1}^n |\inn{x,e_i}|^2\leq ||x||^2
\end{align*}

\begin{fproposition}[Desigualdad de Bessel]
    Sea $S=\{e_\alpha\}_\alpha$ un conjunto o.n. Entonces,

    \[\sum_{\alpha} |\inn{x,e_\alpha}|^2\leq ||x||^2 \]
\end{fproposition}

\[\sum_\alpha r_\alpha:=\sup\left\{\sum_{i\in I}r_i:I\subseteq A\right\}\]

\begin{proof}
    Utilizando $\sum_{i=1}^n |\inn{x,e_i}|^2\leq ||x||^2$, y tomando supremo.
\end{proof}

\paragraph{Consecuencias} $\{\alpha:\inn{x,e_\alpha}\neq 0\}=\bigcup_{n=1}^\infty \{\alpha \in A:|\inn{x,e_\alpha}|\geq \frac{1}{n}\}$ es \textbf{contable}: Si es infinito: $|\inn{x,e_{\alpha_k}}|^2>\frac{1}{n^2}, k=1,\ldots$. Sumando suficientes términos superaríamos $||x||^2$, que no es posible por Bessel.

\begin{fdefinition}
    \[\hat x(\alpha)=\inn{x,e_\alpha}\]

    \textbf{coeficientes de Fourier} respecto a $\{e_\alpha\}$
\end{fdefinition}

\[\sum_\alpha |\hat x(\alpha)|^2\leq ||x||^2\]

¿Cuando tenemos igualdad?

\begin{ftheorem}
    Sea $\mathcal{B}=\{e_\alpha\}_{\alpha\in A}$ un subconjunto o.n. del espacio de Hilbert $H$. Los siguientes enunciados son equivalentes:

    \begin{enumerate}
        \item \[\sum_\alpha |\hat x(\alpha)|^2=||x||^2\]
        \item $\mathcal{B}$ es \textbf{maximal} en el sentido de:
        
        Si $x\in H$, tal que $x\perp e_\alpha,\forall \alpha\in A\implies x=0$

        \item $\forall x\in H$, 
        
        \[x=\sum_{\alpha}\inn{x,e_\alpha}e_\alpha\]

        donde la suma en el lado derecho tiene solo un número contable de términos no ceros y la suma de estos converge a $x$ en $||\cdot||$ independiente de su orden.

        \item $\gen(\mathcal{B})$ es denso en $H$
    \end{enumerate}
\end{ftheorem}

\begin{fdefinition}
    Decimos que un conjunto $\{e_\alpha\}_{\alpha\in A}$ o.n. es una \textbf{base ortonormal} si satisface cualquiera de $\emph{1.-4.}$
\end{fdefinition}

\begin{proof}
    $\emph{2.}\implies \emph{3.}$ Sea $e_{\alpha_1},\ldots,e_{\alpha_n},\ldots$ una enumeración de los $\{e_\alpha\}_{\alpha\in \mathcal{J}}$ para los cuales $\hat x(\alpha)\neq 0$. Por Bessel:

    \[\sum_{k=1}^\infty |\hat x(\alpha_k)|^2\leq ||x||^2<\infty\]

    \[\implies \sum_{k=n}^m |\hat x(\alpha_k)|^2\xrightarrow{m,n\to\infty} 0\]

    Por Pitagoras,

    \[||\sum_{k=n^m}\inn{x,e_{\alpha_k}}e_{\alpha_k}||\xrightarrow
    {m,n\to\infty} 0\]

    Sea $S_n=\sum_{k=1}^n \hat x(\alpha_k)e_{\alpha_k}$. $\{S_n\}$ es Cauchy en $H$

    \[\implies S_n\xrightarrow{n\to\infty} S\quad\text{en $H$}\]

    Además 

    \begin{align*}
        \inn{x-S,e_\alpha}&=\inn{x,e_\alpha}-\inn{S,e_\alpha}\\
        &=\inn{x,e_\alpha}-\lim_{n\to\infty} \inn{S_n,e_\alpha}\\
        &=\begin{cases}
            0 &\text{cuando $\alpha\in \mathcal{J}$}\\
            0 &\text{cuando $\alpha\notin \mathcal{J}$}
        \end{cases}
        &\implies x-S=0\implies x=S
    \end{align*}

    $\emph{3.}\implies \emph{1.}$: Por continuidad de la norma 

    \begin{align*}||x||^2&=||\lim_{n\to\infty} S_n||^2\\
        &=\lim_{n\to\infty} ||S_n||^2\\
        &=\lim_{n\to\infty} \sum_{k=1}^n |\hat x(\alpha_k)|^2\\
        &=\sum_\alpha |\hat x(\alpha)|^2
    \end{align*}

    $\emph{1.}\implies \emph{2.}$: obvio 

    \[||x||^2=\sum_\alpha |\inn{x,e_\alpha}|^2=0\implies x=0\]

    $\emph{3.}\implies \emph{4.}$: Si $x\perp e_\alpha,\quad\forall \alpha$, 

    \begin{align*}
        &\implies x\perp \gen(\{e_\alpha\})\\
        &\overset{\text{continuidad}}{\implies} x\perp \overline{\gen(\{e_\alpha\})}=H\\
        &\implies x=0
    \end{align*}

\end{proof}

\begin{fexample}
    $\ell^2$, $e_k=\{(0,\ldots,\underbrace{1}_k,0,\ldots)\},k\in\N$.

    \[||x||^2=\sum |x_i|^2=\sum |\inn{x,e_i}|^2\]
\end{fexample}

\begin{ftheorem}
    Todo espacio de Hilbert tiene una \textbf{base ortonormal}.
\end{ftheorem}

\begin{proof}
    Utiliza el Lema de Zorn
\end{proof}

\begin{fdefinition}
    $X$ espacio métrico es \textbf{separable} si existe un subconjunto $C\subseteq X$ contable y denso en $X$.
\end{fdefinition}

\begin{fexample}
    $\ell^p,p\in [1,\infty)$ es separable. 

    $L^2([0,1])$ es separable. $\text{Polinomios con coeficientes$\in\K$}\ovserset{\text{denso}}{\subseteq}C([0,1])\overset{\text{denso}}{\subseteq} L^2([0,1])$
\end{fexample}